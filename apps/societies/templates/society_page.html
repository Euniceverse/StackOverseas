{% extends "base.html" %}
{% load static %}

{% block title %}
  Society Page - {{ society.name }}
{% endblock %}

{% block content %}
<div class="container my-5" style="max-width: 900px;">
    <h2 class="fw-bold mb-4">{{ society.name }}</h2>
    
    <p>{{ society.description }}</p>
    <p><strong>Type:</strong> {{ society.society_type }}</p>
    <p><strong>Members:</strong> {{ society.members_count }}</p>

    {% if can_manage %}
        <div class="management-controls">
            <a href="{% url 'manage_society' society.id %}" class="btn btn-warning">
            Manage Members
            </a>
            <a href="{% url 'manage_display' society.id %}" class="btn btn-warning">
            Manage Display
            </a>
            <a href="{% url 'event_create' society.id %}" class="btn btn-primary">
            Create Event
            </a>
        </div>
    {% endif %}

</div>

{% if user.is_authenticated %}
{% else %}
{% endif %}

<div id="widgets-container">
  <ul id="sortable-widgets">
    {% for widget in widgets %}
      <li class="widget">
          <h3>{{ widget.get_widget_type_display }}</h3>
          {% if widget.widget_type == "announcements" %}
              {% include 'announcements.html' with widget=widget %}
          {% elif widget.widget_type == "events" %}
              {% include 'events.html' with widget=widget %}
          {% elif widget.widget_type == "gallery" %}
              {% include 'gallery.html' with widget=widget %}
          {% elif widget.widget_type == "contacts" %}
              {% include 'contacts.html' with widget=widget %}
          {% elif widget.widget_type == "featured" %}
              {% include 'featured.html' with widget=widget %}
          {% elif widget.widget_type == "leaderboard" %}
              {% include 'leaderboard.html' with widget=widget %}
          {% elif widget.widget_type == "news" %}
              {% include 'news.html' with widget=widget %}
          {% else %}
              <div class="default-widget">
                  {{ widget.custom_html|safe }}
              </div>
          {% endif %}
          {% if can_manage %}
              <a href="{% url 'edit_widget' society.id widget.id %}" class="btn btn-sm btn-info">Edit</a>
          {% endif %}
      </li>
    {% endfor %}
  </ul>
</div>
{% endblock %}

{% block extra_scripts %}
<script src="{% static 'js/society_page.js' %}" defer></script>
<script src="{% static 'js/join_society.js' %}" defer></script>
{% endblock %}
